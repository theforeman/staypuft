<%= render :layout => 'title' do %>
  <%= alert_if_deployed %>

  <%= form_for(@deployment, :url => wizard_path, :method => 'PUT') do |f| %>
    <%= base_errors_for @deployment %>

    <div class="wizard-container">
      <%= deployment_wizard 1 %>
    </div>

    <%= text_f f, :name %>
    <%= textarea_f f, :description, :rows => 3 %>

    <%= field(f, :layout_id, :label => _('Deployment Layout')) do
      @layouts.map do |layout|
        radio_button_f_non_inline(f, :layout_id,
                                  :checked => layout.id == @deployment.layout_id,
                                  :value   => layout.id,
                                  :text    => "#{layout.name}, #{layout.networking.capitalize} " + _("Networking"))
      end.join
    end %>

    <%= field(f, :layout_id, :label => _('Messaging provider')) do
      Staypuft::Deployment::AMQP_PROVIDER_LABELS.map do |provider_value, provider_label|
        radio_button_f_non_inline(f, :amqp_provider,
                                  :checked => provider_value == @deployment.amqp_provider,
                                  :value   => provider_value,
                                  :text    => provider_label)
      end.join
    end %>

    <div class="form_actions">
      <% if !is_new %>
        <%= link_to _("Cancel"), deployment_path(@deployment),
                    :class => "btn btn-danger" %>
      <% else %>
        <%= link_to _("Cancel"), deployment_path(@deployment),
                    :method  => :delete,
                    :confirm => _("This will clear whole deployment configuration. Are you sure?"),
                    :class   => "btn btn-danger" %>
      <% end %>
      <%= button_tag(:type => 'submit', :class => "btn btn-primary pull-right") do %>
        <%= _("Next") %>
        <span class="glyphicon glyphicon-chevron-right"></span>
      <% end %>
    </div>
  <% end %>
<% end %>
